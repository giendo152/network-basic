# Лабораторная работа. Просмотр таблицы MAC-адресов коммутатора 

# Топология

![Image alt](https://github.com/giendo152/network-basic/blob/main/practice/pra2/topologi.png)



#	Таблица адресации

| Устройство       | Интерфейс          |       IP-адрес    | Маска подсети |
| ---------------- |:------------------:| -----------------:|--------------:|
| S1               |VLAN 1              |   192.168.1.11    | 255.255.255.0 |
| S2               |VLAN 1              |   192.168.1.12    | 255.255.255.0 |
| PC-A             |NIC                 |   192.168.1.1     | 255.255.255.0 |
| PC-A             |NIC                 |   192.168.1.2     | 255.255.255.0 |

#	Общие сведения/сценарий

Коммутатор локальной сети на уровне 2 предназначен для доставки кадров Ethernet всем узловым устройствам в локальной сети (LAN). Он записывает МАС-адреса узлов, отображаемые в сети, и сопоставляет их с собственными портами коммутатора Ethernet. Этот процесс называется созданием таблицы МАС-адресов. Получив кадр от ПК, коммутатор изучает МАС-адреса источника и назначения кадра. MAC-адрес источника регистрируется и сопоставляется с портом коммутатора, от которого он был получен. Затем по таблице MAC-адресов определяется МАС-адрес назначения. Если MAC-адрес назначения известен, кадр пересылается через соответствующий порт коммутатора, связанный с этим MAC-адресом. Если MAC-адрес неизвестен, то кадр отправляется по широковещательной рассылке через все порты коммутатора, кроме того, через который он был получен. Важно видеть и понимать работу коммутатора и то, как он осуществляет передачу данных по сети. Понимание функционала коммутатора особенно важно для сетевых администраторов, задача которых заключается в обеспечении безопасной и стабильной работы сети.
Коммутаторы используются для соединения компьютеров в локальных сетях (LAN) и передачи данных между ними. Коммутаторы отправляют кадры Ethernet на узловые устройства, которые идентифицируются по МАС-адресам сетевых плат.
В части 1 вам нужно построить топологию, состоящую из двух коммутаторов, соединенных транком. В части 2 вам предстоит отправить эхо-запросы различным устройствам и посмотреть, как два коммутатора строят свои таблицы МАС-адресов.

# Примечание. 
В лабораторной работе используются коммутаторы Cisco Catalyst 2960s с операционной системой Cisco IOS 15.2(2) (образ lanbasek9). Допускается использование других моделей коммутаторов и других версий Cisco IOS. В зависимости от модели устройства и версии Cisco IOS доступные команды и результаты их выполнения могут отличаться от тех, которые показаны в лабораторных работах.
Примечание: Убедитесь, что все настройки коммутатора удалены и загрузочная конфигурация отсутствует. Если вы не уверены в этом, обратитесь к инструктору.

#	Необходимые ресурсы

•	2 коммутатора (Cisco 2960 с операционной системой Cisco IOS 15.2(2) (образ lanbasek9) или аналогичная модель)

•	2 ПК (Windows и программа эмуляции терминала, такая как Tera Term)

•	Консольные кабели для настройки устройств Cisco IOS через консольные порты.

•	Кабели Ethernet, расположенные в соответствии с топологией

# Примечание. 

Интерфейсы Fast Ethernet на коммутаторах Cisco 2960 определяют тип подключения автоматически, поэтому между коммутаторами S1 и S2 можно использовать прямой кабель Ethernet. При использовании коммутатора Cisco другой модели может потребоваться перекрестный кабель Ethernet.

# Инструкции

# Часть 1. Создание и настройка сети

# Шаг 1. Подключите сеть в соответствии с топологией.

# Шаг 2. Настройте узлы ПК.

# Шаг 3. Выполните инициализацию и перезагрузку коммутаторов.

# Шаг 4. Настройте базовые параметры каждого коммутатора.

a.	Настройте имена устройств в соответствии с топологией.

b.	Настройте IP-адреса, как указано в таблице адресации.

```S2>en

S2#conf t

Enter configuration commands, one per line.  End with CNTL/Z.

S2(config)#int vlan 1

S2(config-if)#ip add

S2(config-if)#ip address 192.168.1.12 255.255.255.0

S2(config-if)#no sh

S2(config-if)#no shutdown 
```

c.	Назначьте cisco в качестве паролей консоли и VTY.

```S1#conf t

Enter configuration commands, one per line.  End with CNTL/Z.

S1(config)#line con

S1(config)#line console 0

S1(config-line)#pass

S1(config-line)#password cisco

S1(config)#line con

S1(config)#line console 0

S1(config-line)#pass

S1(config-line)#password cisco
```

d.	Назначьте class в качестве пароля доступа к привилегированному режиму EXEC.

```S1#conf t

S1(config)#en password class

S1(config)#exit
```

# Часть 2. Изучение таблицы МАС-адресов коммутатора

Как только между сетевыми устройствами начинается передача данных, коммутатор выясняет МАС-адреса и строит таблицу.

# Шаг 1. Запишите МАС-адреса сетевых устройств.

a.	Откройте командную строку на PC-A и PC-B и введите команду ipconfig /all.

Назовите физические адреса адаптера Ethernet.

MAC-адрес компьютера PC-A: 0001.6483.4141

MAC-адрес компьютера PC-B: 000A.F3CD.B205

b.	Подключитесь к коммутаторам S1 и S2 через консоль и введите команду show interface F0/1 на каждом коммутаторе.

Назовите адреса оборудования во второй строке выходных данных команды (или зашитый адрес — bia).

МАС-адрес коммутатора S1 Fast Ethernet 0/1: 0050.0fcc.dc01

МАС-адрес коммутатора S2 Fast Ethernet 0/1: 0001.c970.c001

# Шаг 2. Просмотрите таблицу МАС-адресов коммутатора.

Подключитесь к коммутатору S2 через консоль и просмотрите таблицу МАС-адресов до и после тестирования сетевой связи с помощью эхо-запросов.

a.	Подключитесь к коммутатору S2 через консоль и войдите в привилегированный режим EXEC.

b.	В привилегированном режиме EXEC введите команду show mac address-table и нажмите клавишу ввода.

S2# show mac address-table

Даже если сетевая коммуникация в сети не происходила (т. е. если команда ping не отправлялась), коммутатор может узнать МАС-адреса при подключении к ПК и другим коммутаторам.

Записаны ли в таблице МАС-адресов какие-либо МАС-адреса?

```S2# show mac address-table
          Mac Address Table
-------------------------------------------

Vlan    Mac Address       Type        Ports
----    -----------       --------    -----

   1    0050.0fcc.dc01    DYNAMIC     Fa0/1
S2#
```

Какие МАС-адреса записаны в таблице? С какими портами коммутатора они сопоставлены и каким устройствам принадлежат? Игнорируйте МАС-адреса, сопоставленные с центральным процессором.

Ответ:

В таблице MAC-адресов может быть записано несколько MAC-адресов, особенно MAC-адресов, полученных через порт коммутатора F0/1 S1. В приведенном выше примере MAC-адрес S1 F0/1 и MAC-адрес PC-A сопоставляются с S2 F0/1.

Если вы не записали МАС-адреса сетевых устройств в шаге 1, как можно определить, каким устройствам принадлежат МАС-адреса, используя только выходные данные команды show mac address-table? Работает ли это решение в любой ситуации?

Ответ:

Выходные данные команды show mac address-table показывают порт, на котором был получен MAC-адрес. В большинстве случаев это позволит определить, какому сетевому устройству принадлежит MAC-адрес, за исключением случаев, когда несколько MAC-адресов связаны с одним и тем же портом. Это происходит, когда коммутаторы подключены к другим коммутаторам и записывают все MAC-адреса устройств, подключенных к другому коммутатору.

# Шаг 3. Очистите таблицу МАС-адресов коммутатора S2 и снова отобразите таблицу МАС-адресов.

a.	В привилегированном режиме EXEC введите команду clear mac address-table dynamic и нажмите клавишу Enter.

S2# clear mac address-table dynamic

b.	Снова быстро введите команду show mac address-table.

Указаны ли в таблице МАС-адресов адреса для VLAN 1? Указаны ли другие МАС-адреса?

```S2#clear mac address-table dynamic

S2#show mac address-table

          Mac Address Table
-------------------------------------------

Vlan    Mac Address       Type        Ports
----    -----------       --------    -----

   1    0050.0fcc.dc01    DYNAMIC     Fa0/1
```

Через 10 секунд введите команду show mac address-table и нажмите клавишу ввода. Появились ли в таблице МАС-адресов новые адреса?

```S2#show mac address-table
          Mac Address Table
-------------------------------------------

Vlan    Mac Address       Type        Ports
----    -----------       --------    -----

   1    0050.0fcc.dc01    DYNAMIC     Fa0/1
```

# Шаг 4. С компьютера PC-B отправьте эхо-запросы устройствам в сети и просмотрите таблицу МАС-адресов коммутатора.

```S1#show mac address-table

          Mac Address Table
-------------------------------------------

Vlan    Mac Address       Type        Ports
----    -----------       --------    -----

   1    0001.c970.c001    DYNAMIC     Fa0/1
```

a.	На компьютере PC-B откройте командную строку и еще раз введите команду arp -a.

```C:\>arp -a
No ARP Entries Found
```

Не считая адресов многоадресной и широковещательной рассылки, сколько пар IP- и МАС-адресов устройств было получено через протокол ARP?

Ответ:

В кэше ARP может не быть записей, или он может иметь сопоставление IP-адреса шлюза с MAC-адресом.

b.	Из командной строки PC-B отправьте эхо-запросы на компьютер PC-A, а также коммутаторы S1 и S2.

От всех ли устройств получены ответы? Если нет, проверьте кабели и IP-конфигурации.

```C:\>ping 192.168.1.1

Pinging 192.168.1.1 with 32 bytes of data:

Reply from 192.168.1.1: bytes=32 time<1ms TTL=128
Reply from 192.168.1.1: bytes=32 time<1ms TTL=128
Reply from 192.168.1.1: bytes=32 time<1ms TTL=128
Reply from 192.168.1.1: bytes=32 time=5ms TTL=128

Ping statistics for 192.168.1.1:
    Packets: Sent = 4, Received = 4, Lost = 0 (0% loss),
Approximate round trip times in milli-seconds:
    Minimum = 0ms, Maximum = 5ms, Average = 1ms

C:\>ping 192.168.1.12

Pinging 192.168.1.12 with 32 bytes of data:

Request timed out.
Reply from 192.168.1.12: bytes=32 time<1ms TTL=255
Reply from 192.168.1.12: bytes=32 time<1ms TTL=255
Reply from 192.168.1.12: bytes=32 time<1ms TTL=255

Ping statistics for 192.168.1.12:
    Packets: Sent = 4, Received = 3, Lost = 1 (25% loss),
Approximate round trip times in milli-seconds:
    Minimum = 0ms, Maximum = 0ms, Average = 0ms

C:\>ping 192.168.1.11

Pinging 192.168.1.11 with 32 bytes of data:

Request timed out.
Reply from 192.168.1.11: bytes=32 time=5ms TTL=255
Reply from 192.168.1.11: bytes=32 time<1ms TTL=255
Reply from 192.168.1.11: bytes=32 time<1ms TTL=255

Ping statistics for 192.168.1.11:
    Packets: Sent = 4, Received = 3, Lost = 1 (25% loss),
Approximate round trip times in milli-seconds:
    Minimum = 0ms, Maximum = 5ms, Average = 1ms

C:\>ping 192.168.1.2

Pinging 192.168.1.2 with 32 bytes of data:

Reply from 192.168.1.2: bytes=32 time=1ms TTL=128
Reply from 192.168.1.2: bytes=32 time=3ms TTL=128
Reply from 192.168.1.2: bytes=32 time=5ms TTL=128
Reply from 192.168.1.2: bytes=32 time=3ms TTL=128

Ping statistics for 192.168.1.2:
    Packets: Sent = 4, Received = 4, Lost = 0 (0% loss),
Approximate round trip times in milli-seconds:
    Minimum = 1ms, Maximum = 5ms, Average = 3ms

c.	Подключившись через консоль к коммутатору S2, введите команду show mac address-table.

Добавил ли коммутатор в таблицу МАС-адресов дополнительные МАС-адреса? Если да, то какие адреса и устройства?

На компьютере PC-B откройте командную строку и еще раз введите команду arp -a.

Появились ли в ARP-кэше компьютера PC-B дополнительные записи для всех сетевых устройств, которым были отправлены эхо-запросы?

# Вопрос для повторения

В сетях Ethernet данные передаются на устройства по соответствующим МАС-адресам. Для этого коммутаторы и компьютеры динамически создают ARP-кэш и таблицы МАС-адресов. Если компьютеров в сети немного, эта процедура выглядит достаточно простой. Какие сложности могут возникнуть в крупных сетях?
